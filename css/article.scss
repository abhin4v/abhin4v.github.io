@import "default";
@import "consts";
@import "posts";
@import "comments";
@import "toc";
@import "sidenotes";
@import "pager";
@import "webmentions";
@import "syntax";
@import "subscription";
@import "underline";

%ref-link {
    content: url('data:image/svg+xml; utf8, <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z" /></svg>');
    display: inline-block;
    margin-left: .4em;
    vertical-align: middle;
    position: relative;
    top: -0.1em;
}

%top-link {
    content: url('data:image/svg+xml; utf8, <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 8 8"><path d="M2.47 0l-2.47 3h2v5h1v-5h2l-2.53-3z" transform="translate(1)" /></svg>');
    display: inline-block;
    float: right;
    position: relative;
}

#mentions-container, #comment-container {
    h2, h3 {
        a {
            &.ref-link:after {
                @extend %ref-link;
            }
            &.top-link:after {
                @extend %top-link;
            }
        }
    }
}

article.post {
    a.img-link {
        text-decoration: none;
        color: inherit;
        img {
            border: 1px solid #ddd;
            margin: 0px auto;
            display: block;
            padding: 0.2em;
            max-width: 100%;
        }
        span {
            display: block;
            text-align: center;
            font-size: 0.8em;
        }
    }
    td.hljs-ln-code {
        padding-left: 0.5em;
    }
    td.hljs-ln-numbers {
        color: brown;
        vertical-align: top;
        border-right: 1px solid #aaa;
        padding-right: 0.5em;
        font-size: smaller;
    }
    pre {
        white-space: pre-wrap;
        word-wrap: break-word;
        background-color: #fafafa;
        border: solid lighten($border-color, 28%);
        border-width: 2px 0;
        position: relative;

        &.small {
            font-size: 80%;
            white-space: pre;
            code {
                overflow-x: scroll;
                overflow-y: hidden;
                display: flex;
            }
            @media screen and (min-width: 55rem) {
                &.overflow code {
                  overflow-x: initial;
                  overflow-y: initial;
                }
            }
        }
    }
    .footnotes {
        p {
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            line-height: normal;
        }
        ol::before {
            content: "Footnotes";
            margin-left: -2em;
        }
        blockquote {
            margin: auto;
        }
	li:target {
            background-color: #fef9cc;
        }
	a.footnote-back {
            background-image: none !important;
        }
    }
    .scrollable-table {
        overflow-x: auto;
    }
    blockquote {
        border-left: 10px solid #ccc;
        padding: 0 0.5em;

        p {
            margin: 0.7em auto;
        }
    }
    .twitter-button {
        line-height: 0.8em;
    }
    .source {
        font-size: 0.8em;
    }
    section.body {
        h2, h3 {
            a {
                &.ref-link {
		    background-image: none !important;
		    &:after {
                        @extend %ref-link;
                    }
	        }
                &.top-link {
		    background-image: none !important;
		    &:after {
                        @extend %top-link;
                    }
	        }
            }
        }
        ul {
          @include fancy-ul();
        }
        a[href] {
           @include link-underline($background-color, $link-color, $selection-color);
        }
        > .scrollable-table table {
            border-collapse: collapse;
            min-width: 40%;
            th {
                font-weight: bold;
            }
            td, th {
                padding: 0.2em 1em;
            }
            thead {
                border-top: 2px solid lighten($text-color, 30%);
                border-bottom: 2px solid lighten($text-color, 30%);
                display: table-row-group;
            }
            tbody {
                tr {
                    border-bottom: 1px solid lighten($text-color, 30%);
                }
            }
        }
    }
}

body.article-page {
    article.post {
        section.body > p:first-child::first-letter {
            float: left;
            font-size: 4.5em;
            line-height: 0.7em;
            margin: 0.1em 0.15em 0 0;
        }
    }
    form#subscription {
      margin-left: 1em;
      margin-bottom: 1em;
    }
}

.no-js div.twitter-button {
    display: none;
}

@media screen and(max-width: 640px) {
    article.post {
        section.body {
            > .scrollable-table table {
                td, th {
                    padding: 0.2em 0.2em;
                }
                min-width: 60%;
            }
        }
        blockquote {
            margin: auto 1em;
            ul {
                padding-left: 1em!important;
            }
        }
	.footnotes {
            ol {
	        padding-left: 1em;
            }
            ol::before {
	        margin-left: -1em;
            }
        }
    }
}

@media screen and(max-width: 900px) {
    #home-posts {
        article.post {
            section.header {
                text-align: right;
            }
        }
    }
}

@media print {
    article.post {
        h1 {
            font-size: 2.7em!important;
        }
        .twitter-share-button, .post-comments, .post-download {
            display: none!important;
        }
        p, li, blockquote {
            page-break-inside: avoid;
        }
        pre {
            border: none!important;
            page-break-inside: avoid;
        }
        pre.small {
            font-size: 0.76em;
            white-space: pre-wrap;
            code {
                overflow-x: hidden;
            }
        }
        .source {
            display: none!important;
        }
        ul.headers {
            display: block;
            li {
                display: list-item;
                text-align: right;
            }
        }
        section.body {
            > .scrollable-table table {
                page-break-inside: avoid;
            }
            a:after {
                display: none!important;
            }
        }
        td.hljs-ln-numbers {
            border-right: none;
        }
    }
    #gen-time {
      display: none!important;
    }
}
